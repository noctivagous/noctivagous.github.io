NIBGLIDER DESIGN DOCUMENT


Introduction

Nibglider is a vector-drawing program in which
mouse clicks are replaced by keyboard key
presses (sometimes called "key-clicks" here). 
The mouse continues to steer the cursor 
but its buttons are unused by the program.  
When key-clicks are implemented comprehensively, 
with the whole of a vector-drawing program's
interactions and tools redesigned, 
an altogether new form of interaction with 
desktop software drawing occurs.  

Polyline Key As Base Reference

Laying down a polyline, which is a series of line segments
that can close into a polygon shape or remain open,
involves moving the mouse and pressing the F
key-- the Polyline key-- to deposit each point.  
After the first point is deposited, a line extends to the
cursor of the mouse and adjusts its angle and length as the user
moves the cursor, and this continues until
the user terminates the entire sequence of points
with the A key (the main termination key for other
shape and drawing tools as well).  The interaction is the
same as the Polygon Lasso tool in Adobe Photoshop
except that the lines drawn onscreen are used 1:1 
to make vectors for the drawing, and 
the F key has been designated to replace the mouse click
for this function.  So, the user does not have to
switch to the Path tool because it is implicitly
activate as soon as the F key is pressed. 
The Polyline key, F, belongs to the Path tool,
and there are other keys that are also associated with the Path
tool to deposit specific contours on the live path (spline), 
including Curve and Rounded Corner.  They 
are color-coded the same on the keyboard to indicate they
belong to the Path Tool.  So: instead of the user switching
to a Path tool and clicking and dragging with the mouse to manipulate 
a Bezier Path directly, he constructs a path in real time with different
keys, which means that real drawing can occur
with the mouse and keyboard used in alternation.

We start by mentioning the Polyline key because depositing
one or more line segments with points like this 
is the basis for most drawing tools.  It is the
means for drawing for a myriad of shapes in
different ways: a single line segment can
can be used as either the diameter or radius 
of a circle and as the line adjusts the circle
resizes accordingly.  This is the basis of the Circle Tool,
which uses the diameter or radius to draw circles and 
any shape that has a radius (e.g. a regular polygon) 
or has been made to use one. As it is drawn it will sit 
inside a circle. The individual line segment assists
in sizing and making premade shapes. For the Rectangle Tool, the
single line segment is set up to act as the live 
diagonal of a rectangle in the Rectangle By Diagonal key.
It acts as the centerline for the Rectangle By Centerline key.  
A third key belonging to the Rectangle Tool is the
Rectangle by Two Edges key: laying down two segments
as if using the Polyline key allows the user to lay 
down the bounds of a rectangle at any needed angle or size
whereas drawing a rectangle by its diagonal is set up
to be an upright rectangle and drawing it by its centerline
requires the width parameter.  Then, four line segments 
is the basis of the Quadrilateral Tool, which will draw
inside the bounds of a quadrilateral any configured shape, 
including just a quadrilateral.  An example usage includes an ellipse,
which allows depositing circles in perspective quickly.

When the shape tools are naturally located next to each other
on the keyboard and they utilize the same termination
keys, A for complete and Q for cancel, the keyboard
as it is provided for typing is recast as a set of
buttons. This ends up providing the user much greater fluidity and
control over the drawing.  The program provides a live, 
interactive drawing experience that effects the use of a mechanical
device because the user's alternation of key presses and 
mouse movement, whether to lay down points for paths and shapes
or move vector objects, feels like working with a physical machine. 
The user can select from a wide array of functions while moving 
the mouse on the keyboard.

As mentioned, during drawing of a path, the path tool is represented by 
multiple keys on the keyboard, one for just
depositing the hard corners for polylines (the Polyline key) another for round
corners, and curves.  The user may start out laying down
curves with keys and transition to different contours, 
achieving a complex shape in a single sequence by using the different
path tool keys while moving the mouse-- without ever
editing any control points of a bezier path.  Because
this is live drawing and the keyboard provides many
buttons, in mid-drawing the user can adjust drawing parameters such
as the stroke width of the path with the - and = keys.
That is, with a brief amount of practice,
the user is drawing graphics fluidly like on paper but with
vector lines.  Because there are many keys available,
an onscreen keyboard overlayed on top of the drawing canvas 
provides a reference for the user.

The Tab key is utilized as the Select key-click, the
equivalent to the left mouse button + Shift key that
selects objects, and this is much faster.  It reveals
again how mouse button clicks slow down the user
compared to placing them on the keyboard.
There is also no need to press the mouse button
to drag objects because after they are selected,
they can be quickly placed into a drag-lock ("sticky drag") 
when Spacebar is pressed.  The selected objects 
are locked into a drag mode, moving in lock step the
cursor, after the spacebar is pressed.  When
the spacebar is pressed again, the objects are
released. The combination of Tab as the Select key 
and Spacebar as activation and release of drag-lock produces another fluid
mechanical dynamic for the program and works with
the other drawing features.  Keys are chosen for their
location and size: objects are selected with the Tab key 
because it is easy to hit without looking at the keyboard
and the Spacebar is the same.  They are easily used in
rapid alternation.

A drawing tool may have multiple keys on the 
keyboards. There are two Circle tool buttons, B and N,
B for radius and N for diameter.  This program,
though, takes a different route and goes beyond
just the shape of the tool. The
Circle tool, like the Rectangle tool and
Quad tool, are not designed just for their
namesake shape.  They are actually drawing
a container and the user chooses what
is inside that container, such as either
a circle or a spiral for the Circle tool.  
These tools have a selected shape property 
for the object that fits inside their shape 
frame.  In this way, the Rectangle tool, if
it is drawing a rectangle from two points
of a diagonal, can be using a Grid shape
for its frame.  These are the shapes provided
for each of these specific shape tools, but 
a user can also load a custom shape 
from the drawing into the Loaded Object slot
in the app user interface and if "Loaded Object"
is selected as the selected shape for
a given tool, such as Quad, that tools will
draw it live inside the bounds of its frame.



 DrawingManager
    drawingState: [idle,isInDrawing]
    drawingTools: [pathTool,rectangleTool,circleTool,quadTool, arcTool, stampTool]
    currentDrawingTool : none    // reset after 
    combinatoricMode: [none, union, subtraction, intersection]
    drawingLayers : []
    currentDrawingLayer: layer1
    snappingModes: [angleSnapping, lengthSnapping, pointSnapping, pathSnapping]
    snappingModesConfig: {angleSnapping: { snapAngleInDegrees:15, on:false },
    { on:false },{  on:false },{  on:false }    
    loadedObject - This is the object loaded by the user, which can be
    selected by any tool for 
    
    
 DrawingTool - base class
 
 For drawing tools, most interactive sequences
 serve this purpose: When DrawingManager.drawingState == "idle",
 the first press of a key associated with a tool, such as
 the polylinePt key that is part of the Path Tool,
 will activate the tool.
 

  > PathTool
    interactiveSequence: openEnded
    inputKeyCommands: [polylinePt,curvePt, roundCornerPt]
    depositActivities:
    depositShape: []
    
    With the polyline key,
    



 ShapeTool - base class for shape-making tools

 
    > CircleTool - serves as frame for shapes made with radius or diameter
        interactiveSequence: twoPoint

        inputCommands:[]
        drawingToolMode: [radiusFromOrigin,radiusFromCircumference,diameter]
        depositShapesList: [Circle,Supershape,RegularPolygon]
        currentDepositShape: null // set when interactiveSequence is active 
        depositShapesConfig: {
        
                }
        previewIsFinalOutput:true

        
    > RectangleTool - serves as frame for shapes made with rectangle
        depositShapesList: [Rectangle, Triangle:Right, Triangle:Regular]
        currentDepositShape:
        
        // different ways for the tool to place a rectangle on the canvas,
        // corresponding to specific keys:
        drawingToolMode: diagonal:twoPoint, fromCenter:twoPoint, twoEdges:threePoint, 
        centerLine:twoPoint
        aspectRatio: none // square:1:1  
        // - diagonal is a rectangle drawn from its diagonal, so the
        // first point is stationary and the moving mouse point
        // adjusts the rectangle during drawing until it is finalized with a 
        // termination key (the key itself or another such as the END key).
        //- from center is drawing the rectangle from its center point outwards
        //This allows
        //
        
    > ArcTool
        interactiveSequence: threePoint
        drawingToolMode: byThreePoints, radiusFromOrigin,radiusFromCircumference
        // - three
           
    QuadTool
        // Four points deposited make a quadrilateral
        // that applies a transform to the obj.
        // If it is a rectangle, it will be a quadrilateral
        // shape.  If it is a circle, it will be an ellipse
        // contained in the quadrilateral bounds.
        // This allows for immediate depiction of perspective
        // in 2D vector drawing.
        
        interactiveSequence: fourPoint
        symmetryMode:none // horizontal, vertical for making trapezoids.


    > StampTool
        interactiveSequence: sequenceType:continuous

 
    > DabTool - deposits and then exits
        interactiveSequence: onePoint
        combinatoricMode:none // subtract, union, intersection
        
     
 InteractiveSequence - base class
 
    A drawing tool has one or more interactive sequences
    corresponding to different drawingToolModes.  The interactive
    sequence for making an arc by three points of the arc is different
    than the one starting from the radius.
 
    initWith(name:int e.g. twoPoint, nPointMax:int e.g. 2, tool:DrawingTool)
    name: // e.g. twoPoint
    tool:
    state: isInSequence // idle, isInSequence
    nPointCount: e.g. 1 // after the first point has been provided by
    the user, calls interactiveSequenceDidFinish().
    nPointMax: 2 // e.g. 2 for twoPoint null for requires termination
    reset() // resets state to idle
    
    // callbacks - sent to tool, which follows protocol/interface:
    
    nPointDidChange() // sends 2D point info to tool
    interactiveSequenceWasCanceled() //
    interactiveSequenceDidFinish() //
 
 
 InputManager
 
 InputKeyCommand - e.g. the PathTool has multiple associated keys
 and on keypress the InputManager sends the command to the DrawingManager which
 sends it to the current tool.
 


 NGPath
    mode: bezier,b-spline,ngComposite
    
 NGPathBezier
    mode: bezier
    
    
 Shape inherits from NGPathBezier

    setters and getters
    
        makeFrom
            circumradius:
            radius:
            quadrilateral:
            rect:
            rect:withRotation:atVertex:
        
        get
            circumRadius:
            radius:
        
        
    > Circle
    > Supershape
    > Polygon
        constructors or modes:
            Regular
    > Quadrilateral
        > Rectangle
            > Grid
        constructors or modes:
            Trapezoid
            Rhombus
        
    > Triangle
        constructors or modes:
            Right
            Regular
            3-4-5
            Golden
            
    > Arc    
        constructors or modes:
            Semicircle
            Quarter

    
THE KEYBOARD KEYS

The onscreen keyboard changes to reflect the keys
available when modifier keys are pressed. So,
for example, the [ and ] keys will scale a selected 
object.  Shift + [ or ] will scale with a higher
factor and so when Shift is pressed, the label for
the [ and ] keys will change to show "Scale Up Upper"
instead of the baseline "Scale Up".  To achieve
this, there is a keyboardMappings.plist file
in which each entry is prefixed with 
Cocoa keyboard bindings shorthand in front of
the keycode.  So, $30 is for Shift + A while
just 30 is A.  Shift + Command + A is entered
as $@30.

    $ - Shift
    @ - Command/Super
    ^ - Control
    ~ - Option/Alt

Each entry also contains the function to
call in the program when the key is pressed
So, when a key is pressed whatever modifier
combination it is converted to the shorthand
just mentioned and the entry in the
dictionary (.plist) file is found and then
the provided function is called.



STROKE VS. STROKED PATH (A PATH OUTLINE OF THE STROKE)

The stroke of the path is differentiated
from the path made from the stroke, which
is an outline of the path stroked turned
into a path.  This is useful for drawing
strokes.
    - A stroked path with both ends removed
    for a rails or two-track result. 


COMBINATORICS MODES

    Operation applied after
    deposit: Union, Subtraction, Intersection



USEFUL REFERENCES

https://mathworld.wolfram.com/Circumradius.html






