<!DOCTYPE html>
<html>
<head>
    <title>KeyPilot Overlay Fixes Test</title>
    <style>
        body { 
            font-family: system-ui; 
            padding: 20px; 
            line-height: 1.6;
            height: 200vh; /* Make page scrollable */
        }
        .test-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
        }
        .zero-height-link {
            display: block;
            height: 0;
            overflow: visible;
            border: 1px solid red;
            margin: 10px 0;
        }
        .zero-height-link span {
            display: inline-block;
            padding: 10px;
            background: #f0f0f0;
            border: 1px solid #ccc;
        }
        .tall-content {
            height: 100px;
            background: linear-gradient(to bottom, #e3f2fd, #bbdefb);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }
        input, textarea, button { 
            margin: 5px; 
            padding: 8px; 
            font-size: 14px; 
        }
    </style>
</head>
<body>
    <h1>KeyPilot Overlay Fixes Test</h1>
    
    <div class="test-section">
        <h3>Test 1: Scroll Behavior</h3>
        <p>Hover over elements below, then scroll the page. The overlays should move with the elements.</p>
        <button>Test Button 1</button>
        <a href="#test">Test Link 1</a>
        
        <div class="tall-content">
            <button>Button in tall content</button>
        </div>
    </div>
    
    <div class="test-section">
        <h3>Test 2: Mode-Specific Overlays</h3>
        <p>
            1. Hover over elements - should see GREEN overlay<br>
            2. Press D to enter delete mode - should see RED overlay only<br>
            3. Press ESC to exit delete mode - should see GREEN overlay again
        </p>
        <button>Mode Test Button</button>
        <a href="#mode">Mode Test Link</a>
    </div>
    
    <div class="test-section">
        <h3>Test 3: Zero-Height Links</h3>
        <p>These links have zero height but contain elements with height. The overlay should show around the visible content.</p>
        
        <a href="#zero1" class="zero-height-link">
            <span>Link with zero height container</span>
        </a>
        
        <a href="#zero2" class="zero-height-link">
            <span>Another zero height link</span>
            <span>With multiple children</span>
        </a>
        
        <a href="#zero3" style="display: inline; height: 0;">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='50'%3E%3Crect width='100' height='50' fill='%23ff9800'/%3E%3Ctext x='50' y='30' text-anchor='middle' fill='white'%3EImage Link%3C/text%3E%3C/svg%3E" alt="Test Image">
        </a>
    </div>
    
    <div class="test-section">
        <h3>Test 4: Text Focus Mode</h3>
        <p>Click in text fields - overlays should disappear and cursor should change.</p>
        <input type="text" placeholder="Test input">
        <textarea placeholder="Test textarea"></textarea>
    </div>
    
    <div class="test-section">
        <h3>Instructions</h3>
        <ol>
            <li><strong>Scroll Test:</strong> Hover over elements, then scroll - overlays should follow</li>
            <li><strong>Mode Test:</strong> Normal mode = green overlay, Delete mode (D) = red overlay only</li>
            <li><strong>Zero Height Test:</strong> Links with no height should show overlays around their visible children</li>
            <li><strong>Text Focus Test:</strong> Clicking in text fields should hide all overlays</li>
        </ol>
        
        <h4>Keyboard Shortcuts:</h4>
        <ul>
            <li><strong>F</strong> - Activate element under cursor</li>
            <li><strong>D</strong> - Toggle delete mode</li>
            <li><strong>ESC</strong> - Cancel mode / Exit text focus</li>
            <li><strong>C</strong> - Browser back</li>
            <li><strong>V</strong> - Browser forward</li>
        </ul>
    </div>
    
    <!-- More content to make scrolling meaningful -->
    <div style="height: 50vh; background: #f5f5f5; display: flex; align-items: center; justify-content: center;">
        <div>
            <h3>Scroll Test Area</h3>
            <button>Bottom Button</button>
            <a href="#bottom">Bottom Link</a>
        </div>
    </div>
</body>
</html>